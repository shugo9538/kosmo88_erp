<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.kosmo88.logistics_erp.sale.dao.SalesEstimateDAO">

<!-- 거래처 검색 -->
<select id="choiseClient" resultType="SalesClientDTO">
	SELECT * FROM client WHERE type='판매' AND enabled='Y'
</select>

<!-- 담당자 검색 -->
<select id="chiseEmployee" resultType="SalesEmployeeDTO">
	SELECT e.id as id, e.name as name, e.phone as phone, e.email as email, d.name as department_name 
	  FROM employee e, department d
  	 WHERE e.department_id = d.id
       AND e.enabled = 'Y'
</select>

<!-- 견적서 관리 - 견적서 목록(구매) -->
<select id="getEstimateList" resultType="PurchaseEstimateListViewDTO">
	SELECT request_id, begin_date, client_name, client_ceo_name, 
	       client_phone, employee_name, enabled
	  FROM P_ESTIMATE_LIST_VIEW
	 WHERE enabled = 'Y'
	 ORDER BY request_id
</select>

<!-- 견적서 관리 - 견적서 삭제(선택삭제) -->
<update id="deleteEstimate" parameterType="int">
	UPDATE request
	   SET enabled = 'N'
	 WHERE id = #{request_id}
</update>
 	

</mapper>